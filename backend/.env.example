# ================================
# RAPIDO SUR - Backend Configuration
# ================================
# This file contains all environment variables required by the backend.
# Copy this file to .env and fill in the actual values.
# NEVER commit .env to version control!

# ================================
# APPLICATION CONFIGURATION
# ================================
# Environment: development | production | test
NODE_ENV=development

# Port where the backend will run (default: 3000)
PORT=3000

# ================================
# DATABASE CONFIGURATION (PostgreSQL)
# ================================
# DEVELOPMENT: Use localhost or docker service name
# PRODUCTION: Use the database host provided by Hostinger/Dokploy
DB_HOST=localhost
DB_PORT=5432
DB_USERNAME=postgres
DB_PASSWORD=your_secure_password_here_min_16_chars
DB_DATABASE=rapido_sur

# ================================
# JWT AUTHENTICATION
# ================================
# CRITICAL: Generate a secure random string for production!
# Use: node -e "console.log(require('crypto').randomBytes(64).toString('hex'))"
# Example: openssl rand -hex 64
JWT_SECRET=your_super_secret_jwt_key_MUST_be_changed_in_production_min_32_chars
JWT_EXPIRATION=24h

# ================================
# FRONTEND CONFIGURATION (CORS)
# ================================
# DEVELOPMENT: http://localhost:5173
# PRODUCTION: https://your-domain.com (without trailing slash)
FRONTEND_URL=http://localhost:5173

# ================================
# EMAIL CONFIGURATION (SMTP)
# ================================
# Option 1: Gmail SMTP (recommended for development)
# IMPORTANT: Use App-Specific Password, not your regular Gmail password
# How to get it: https://support.google.com/accounts/answer/185833
MAIL_HOST=smtp.gmail.com
MAIL_PORT=587
MAIL_SECURE=false
MAIL_USER=your_email@gmail.com
MAIL_PASSWORD=your_gmail_app_specific_password_16_chars
MAIL_FROM=noreply@rapidosur.cl

# Option 2: SendGrid (recommended for production)
# Register at: https://sendgrid.com/
# MAIL_HOST=smtp.sendgrid.net
# MAIL_PORT=587
# MAIL_SECURE=false
# MAIL_USER=apikey
# MAIL_PASSWORD=your_sendgrid_api_key
# MAIL_FROM=noreply@rapidosur.cl

# Option 3: Hostinger Email (if available)
# MAIL_HOST=smtp.hostinger.com
# MAIL_PORT=587
# MAIL_SECURE=false
# MAIL_USER=noreply@rapidosur.cl
# MAIL_PASSWORD=your_email_password
# MAIL_FROM=noreply@rapidosur.cl

# ================================
# MAINTENANCE ALERTS
# ================================
# Email address of the maintenance manager who will receive preventive alerts
MAINTENANCE_MANAGER_EMAIL=jefe.mantenimiento@rapidosur.cl

# ================================
# LABOR COST CONFIGURATION
# ================================
# Hourly rate for mechanic labor in CLP (Chilean Pesos)
# Example: 15000 CLP/hour = approximately $17 USD/hour
# This is used to calculate total work order costs (parts + labor)
LABOR_COST_PER_HOUR=15000

# ================================
# CRON JOBS (Scheduled Tasks)
# ================================
# Enable/disable automatic preventive alerts
# PRODUCTION: true
# DEVELOPMENT: false (to avoid sending test emails)
ENABLE_CRON=true

# Cron schedule for preventive alerts check
# Format: minute hour day month weekday
# Default: "0 6 * * *" = Every day at 6:00 AM
# Examples:
#   - "0 6 * * *"     = Daily at 6:00 AM
#   - "0 8 * * 1"     = Every Monday at 8:00 AM
#   - "0 */4 * * *"   = Every 4 hours
ALERTS_CRON_SCHEDULE=0 6 * * *

# ================================
# LOGGING
# ================================
# Log level: error | warn | info | debug
# DEVELOPMENT: debug
# PRODUCTION: info
LOG_LEVEL=debug

# ================================
# SECURITY - RATE LIMITING
# ================================
# Time window in milliseconds (default: 60000 = 1 minute)
THROTTLE_TTL=60000

# Maximum number of requests per time window (default: 10)
# PRODUCTION: Adjust based on your needs
THROTTLE_LIMIT=10

# ================================
# DOKPLOY / DOCKER CONFIGURATION
# ================================
# These variables are typically set by Dokploy automatically
# You don't need to set them locally, but they're listed here for reference

# Container health check endpoint
# HEALTH_CHECK_ENDPOINT=/health

# Docker internal network (set by docker-compose)
# DB_HOST=postgres (when running in Docker)

# ================================
# PRODUCTION CHECKLIST
# ================================
# Before deploying to production, ensure:
# [ ] NODE_ENV=production
# [ ] JWT_SECRET is a secure random string (min 32 characters)
# [ ] DB_PASSWORD is strong (min 16 characters, mixed case, numbers, symbols)
# [ ] MAIL_USER and MAIL_PASSWORD are configured with real SMTP credentials
# [ ] FRONTEND_URL points to your production domain (HTTPS)
# [ ] MAINTENANCE_MANAGER_EMAIL is correct
# [ ] ENABLE_CRON=true
# [ ] LOG_LEVEL=info (not debug in production)
# [ ] THROTTLE_LIMIT is appropriate for production traffic
# [ ] All .env files are added to .gitignore
# [ ] Database backups are configured
# [ ] SSL/TLS certificates are configured in Dokploy

# ================================
# DEVELOPMENT TIPS
# ================================
# 1. Copy this file: cp .env.example .env
# 2. Fill in your local values
# 3. Never commit .env to Git
# 4. Use docker-compose.yml for local development with Docker
# 5. Database migrations: npm run migration:run
# 6. Database seeding: npm run seed (if available)

# ================================
# USEFUL COMMANDS
# ================================
# Generate JWT secret:
#   node -e "console.log(require('crypto').randomBytes(64).toString('hex'))"
#
# Generate secure password:
#   openssl rand -base64 24
#
# Test SMTP connection:
#   npm run test:email (if available)
#
# Check health endpoint:
#   curl http://localhost:3000/health
